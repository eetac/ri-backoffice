/*! ri-backoffice ri-backoffice 2017-01-24 */

!function(a){"use strict";function b(b){return b?a.isArray(b)?b:[b]:[]}function c(b,c){c=a.element(c),b.unshift(["$provide",function(a){a.value("$rootElement",c)}])}function d(d,e){var f=["ng"].concat(b(d));return e&&c(f,e),a.injector(f)}function e(b){a.element(document).ready(function(){a.bootstrap(document,[b])})}a.lazy=function(b,c){var f=d(c),g=f.get("$q"),h=[],i=a.noop,j=a.noop,k=a.noop;return{resolve:function(a){return a=g.when(f.instantiate(a)),h.push(a),this},bootstrap:function(){return j(),g.all(h).then(function(){e(b)},i).finally(k)},loading:function(a){return j=a,this},done:function(a){return k=a,this},error:function(a){return i=a,this}}}}(angular),function(){"use strict";function a(a){var b=document.createElement("div");for(var c in a){var d=document.createElement("link");d.href=a[c],d.rel="stylesheet",b.appendChild(d)}return b}function b(a,b){if(!a||!a.length)return b();var c=0,d=function(){++c==a.length&&($.ajaxSetup({async:!0}),b())};$.ajaxSetup({async:!1}),a.forEach(function(a){$.getScript(a,d)})}var c=angular.module("injectorApp",["ngRoute","ngBiscuit","schemaForm","datePicker","ui.select","ui.ace","ui.codemirror","ui.bootstrap","ngFileUpload","ngDroplet","punchCard","nvd3ChartDirectives","flash","ngDialog","angular-loading-bar","pascalprecht.translate","ngCookies","ui.tinymce"],["$rootScopeProvider",function(a){a.digestTtl(15)}]).run(["$rootScope","configs",function(a,b){a.configs=b}]);angular.lazy("injectorApp").resolve(["$http",function(a){return a.get("/configs").then(function(a){c.constant("configs",a.data)})}]).resolve(["$http","$q",function(d,e){var f=e.defer();return d.get("/admin/extensions").then(function(d){c.constant("extensions",d.data);for(var e=d.data,g=$("asset-loader"),h=[],i=0;i<g.length;i++){var j=[],k=g[i],l=k.attributes.src.nodeValue,m=k.attributes.type.nodeValue;if("files"===l)e.files[m]&&e.files[m].length&&(j=j.concat(e.files[m]));else if("pages"===l)for(var n in e.pages){var o=e.pages[n];o.backoffice&&o[m]&&o[m].length&&(j=j.concat(o[m]))}"css"===m?k.appendChild(a(j)):"js"===m&&j&&j.length&&(h=h.concat(j))}b(h,function(){f.resolve()})}),f.promise}]).bootstrap(),$.getMultiScripts=function(a,b){var c=$.map(a,function(a){return $.getScript((b||"")+a)});return c.push($.Deferred(function(a){$(a.resolve)})),$.when.apply($,c)}}(),function(){"use strict";angular.module("injectorApp").config(["$routeProvider","configs","extensions","customMenuProvider",function(a,b,c,d){var e=function(a,b,c,d,e,f){var g=a.defer();return f.auth?e.getUser(function(a){a?(d.defaults.headers.common.Authorization="BEARER "+a.token,b.login=void 0):c.path("/login"),g.resolve()}):(b.allowedUser=!0,g.resolve()),g.promise};e.$inject=["$q","$rootScope","$location","$http","loginProvider","configs"];var f="html/models.html";if(b.backoffice.home&&(f=b.backoffice.home),a.when("/",{templateUrl:f,controller:"MainController",resolve:{app:e}}).when("/model/:schema",{templateUrl:"html/model.html",controller:"ModelController",resolve:{app:e}}).when("/model/:schema/new",{templateUrl:"html/create-and-update.html",controller:"CreateController",resolve:{app:e},reloadOnSearch:!1}).when("/model/:schema/update/:id",{templateUrl:"html/create-and-update.html",controller:"UpdateController",resolve:{app:e},reloadOnSearch:!1}).when("/model/:schema/update/:id/:shard",{templateUrl:"html/create-and-update.html",controller:"UpdateController",resolve:{app:e},reloadOnSearch:!1}).when("/model/:schema/graphs",{templateUrl:"html/graphs.html",controller:"GraphsController",resolve:{app:e}}).when("/login",{templateUrl:"html/login.html",controller:"LoginController",resolve:{app:["$q","$rootScope","$location","loginProvider",function(a,b,c,d){var e=a.defer();return d.getUser(function(a){a?c.path("/"):b.login=!0,e.resolve()}),e.promise}]}}).when("/logout",{resolve:{app:["$q","$rootScope","$location","loginProvider",function(a,b,c,d){var e=a.defer();return d.logout(),c.path("/"),e.resolve(),e.promise}]}}).when("/settings",{templateUrl:"html/settings.html",controller:"SettingsController"}).when("/gallery",{templateUrl:"html/gallery.html",resolve:{app:e}}),c&&c.pages){var g=[];for(var h in c.pages){var i=c.pages[h];i.backoffice&&a.when("/"+i.url,{templateUrl:i.template,controller:i.controller,resolve:{app:e},modelName:i.modelName}),i.menu&&g.push(i.menu)}d.setCustomMenu(g)}a.otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("injectorApp").config(["$translateProvider","$translatePartialLoaderProvider","configs",function(a,b,c){var d=c.backoffice.i18n;if(b.addPart("login"),b.addPart("model"),b.addPart("models"),b.addPart("navbar"),b.addPart("search"),b.addPart("create_update"),b.addPart("version_dialog"),d&&d.length)for(var e=0;e<d.length;e++)b.addPart(d[e]);a.useLoader("$translatePartialLoader",{urlTemplate:"i18n/{part}/{lang}.json"}),a.registerAvailableLanguageKeys(["en","es"]);var f="en";a.fallbackLanguage("en"),a.useLocalStorage(),c.backoffice.uniqueLanguage&&(f=c.backoffice.uniqueLanguage,a.use(f)),a.preferredLanguage(f)}])}(),function(){"use strict";angular.module("injectorApp").provider("customMenu",function(){var a;this.setCustomMenu=function(b){a=b},this.$get=function(){return a}})}(),function(){"use strict";angular.module("injectorApp").provider("loginProvider",function(){this.$get=["$http","$location","cookieStore","$rootScope",function(a,b,c,d){var e={};return a.defaults.headers.common["Client-Type"]="backoffice",a.defaults.headers.common.profile="back",e.login=function(b,e){a.post("/auth/login",b).success(function(f){var g={};g.login=b.login,g.role=f.role,g.token=f.token;var h={path:"/",end:1/0};c.put("user",JSON.stringify(g),h),a.defaults.headers.common.Authorization="BEARER "+f.token,d.$broadcast("login",g),d.allowedUser=!0,e(g)}).error(function(a){var b={path:"/"};c.remove("user",b),d.$broadcast("logout",void 0),d.allowedUser=!1,e(!1)})},e.getUser=function(a){var b=JSON.parse(c.get("user"));b&&!d.allowedUser&&b.login&&(b.password||b.token)?e.login(b,function(c){c?(angular.extend(b,c),a(c)):a(void 0)}):(b||(d.allowedUser=!1),a(b))},e.logout=function(){var a={path:"/"};c.remove("user",a),b.path("/login"),d.$broadcast("logout",void 0)},e}]})}(),function(){"use strict";angular.module("injectorApp").provider("models",function(){var a={},b={};this.override=function(b,c){a[b]=c},this.getService=function(){return b},this.$get=["$rootScope","$http","Upload","configs","common",function(c,d,e,f,g){var h={},i={},j={},k="";return c.$on("logout",function(){b.invalidate()}),c.$on("invalidate",function(){console.log("invalidate models provider"),b.invalidate()}),b.invalidate=function(){j={},i={},h={}},b.getHttp=function(){return d},b.getUpload=function(){return e},b.setShard=function(a,b,c){var d={};d.key=a,d.value=b,d.model=c,j[c]=d},b.getShard=function(a){return j[a]},b.removeShard=function(a){delete j[a]},b.getModels=function(a){k=f.app.prefix,d.get("/schemas").then(function(b){var c=b.data;a(c)})},b.getModel=function(a,b){if(!h[a]&&b)d.get("/schema/"+a).then(function(c){d.get("/schema/"+a+"/formconfig").then(function(d){h[a]={},h[a].schema=c.data,h[a].config=d.data,b(h[a])})});else{if(!h[a]&&!b){var c=JSON.parse($.ajax({type:"GET",url:"/schema/"+a,async:!1}).responseText),e=JSON.parse($.ajax({type:"GET",url:"/schema/"+a+"/formconfig",async:!1}).responseText);return h[a]={},h[a].schema=c,h[a].config=e,h[a]}if(!b)return h[a];b(h[a])}},b.getModelElements=function(a,c,e,f){b.getModel(a,function(g){var h=g.config.plural||g.config.path+"s"||a+"s",i={skip:c,limit:e};b.getShard(a)&&(i[b.getShard(a).key]=b.getShard(a).value),d.post(k+"/"+h,i).success(function(a){f(a.result,a.status.count)})})},b.getModelSchema=function(a,c){b.getModel(a,function(a){return c(a.schema)})},b.getModelConfig=function(a,c){b.getModel(a,function(a){return c(a.config)})},b.postDocument=function(a,c,e){b.getModel(a,function(b){var f=b.config.path||a;d.post(k+"/"+f,JSON.stringify(c)).then(function(a){return e(a)})})},b.getUrl=function(a,b){throw new Error("Not implemented")},b.getDocument=function(a,c,e,f){return f||(f=e,e=void 0),a&&c?void b.getModel(a,function(g){var h=g.config.path||a,i={params:{type:"back"}};b.getModelConfig(a,function(g){e&&g.shard&&g.shard.shardKey?i.params[g.shard.shardKey]=e:b.getShard(a)&&(i.params[b.getShard(a).key]=b.getShard(a).value),d.get(k+"/"+h+"/"+c,i).success(function(a){return f(a,null)}).error(function(a){return f(null,a)})})}):f()},b.putDocument=function(a,c,e,f){b.getModel(a,function(b){var g=b.config.path||a;d.put(k+"/"+g+"/"+c,JSON.stringify(e)).then(function(a){return f(a)})})},b.removeDocument=function(a,c,e,f){f||(f=e,e=void 0),b.getModel(a,function(g){var h=g.config,i=h.path||a,j={params:{}};e&&h.shard&&h.shard.shardKey?j.params[h.shard.shardKey]=e:b.getShard(a)&&(j.params[b.getShard(a).key]=b.getShard(a).value),d.delete(k+"/"+i+"/"+c,j).then(f)})},b.removeDocumentByMongoId=function(a,c,e,f){f||(f=e,e=void 0),b.getModel(a,function(g){var h=g.config,i=g.config.path||a,j={params:{type:"raw"}};e&&h.shard&&h.shard.shardKey?j.params[h.shard.shardKey]=e:b.getShard(a)&&(j.params[b.getShard(a).key]=b.getShard(a).value),d.delete(k+"/"+i+"/"+c,j).then(f)})},b.uploadImage=function(a,c,d,f,g,h){b.getModel(a,function(b){var i=b.config.path||a;e.upload({url:k+"/"+i+"/"+c+"/"+d,data:{index:f},file:g,fileFormDataName:["image"]}).progress(function(a){console.log("percent: "+parseInt(100*a.loaded/a.total))}).success(function(a,b,c,d){h(a)})})},b.uploadFile=function(a,c,d,f,g,h){b.getModel(a,function(b){var i=b.config.path||a;e.upload({url:k+"/"+i+"/"+c+"/"+d,data:{index:f},file:g,fileFormDataName:["file"]}).progress(function(a){console.log("percent: "+parseInt(100*a.loaded/a.total))}).success(function(a,b,c,d){h(a)})})},b.deleteImage=function(a,c,e,f,g){b.getModel(a,function(b){var e=b.config.path||a;d.delete(k+"/"+e+"/"+c+"/image/"+f).then(g)})},b.deleteFile=function(a,c,e,f,g){b.getModel(a,function(b){var e=b.config.path||a;d.delete(k+"/"+e+"/"+c+"/file/"+f).then(g)})},b.getImageUrl=function(a,c,d,e){b.getModel(a,function(b){var c=b.config.path||a,f=k+"/"+c+"/image/"+d+g.getRandomQuery();e(f)})},b.getFileUrl=function(a,c,d,e){b.getModel(a,function(b){var c=b.config.path||a,f=k+"/"+c+"/file/"+d+g.getRandomQuery();e(f)})},b.getSingleModel=function(a,c){i[a]?c(i[a]):b.search(a,{skip:0,limit:1},function(b,d){d>0?(i[a]=b[0],c(b[0])):c(null)})},b.search=function(a,c,e,f){f||(f=e,e=void 0),b.getModelConfig(a,function(g){var h=g.plural||a;e&&g.shard&&g.shard.shardKey?c[g.shard.shardKey]=e:b.getShard(a)&&(c[b.getShard(a).key]=b.getShard(a).value),d.post(k+"/"+h,JSON.stringify(c)).success(function(a){void 0!==a.status.search_count?f(a.result,a.status.search_count):f(a.result,a.status.count)})})},b.export=function(a,c,d,e){b.getModelConfig(a,function(f){var g={},h=f.plural||a;b.getShard(a)&&(g[b.getShard(a).key]=b.getShard(a).value),g.format=c,g.by=f.id,g.query=d||{},b.postAsForm(k+"/"+h+"/export",g),e()})},b.import=function(a,c,d,e,f){b.getModelConfig(a,function(g){var h=g.plural||a;b.getShard(a)&&(e[b.getShard(a).key]=b.getShard(a).value),e.format=c,b.postAsForm(k+"/"+h+"/export",e,"POST",d),f()})},b.postAsForm=function(a,b,c,e){c=c||"post",e&&console.log("FILE",e),console.log("POST AS FORM",a,b,c,e);var f=document.createElement("form");f.setAttribute("method",c),f.setAttribute("action",a+"?token="+d.defaults.headers.common.Authorization.replace("BEARER ",""));for(var g in b)if(b.hasOwnProperty(g)){var h=document.createElement("input");h.setAttribute("type","hidden"),h.setAttribute("name",g),"object"==typeof b[g]?h.setAttribute("value",JSON.stringify(b[g])):h.setAttribute("value",b[g]),f.appendChild(h)}f.submit()},b.getGraph=function(a,c,e){b.getModelConfig(a,function(b){var f=b.path||a;d.post(k+"/"+f+"/graphs/"+encodeURI(c)).success(function(a){e(a)})})},b.galleryGetByPath=function(a,b){d.get(k+"/gallery"+a).success(function(a){b(a)})},b.getFieldFromSchema=function(a,c){if(c[a])return c[a];var d,e=a.split(".");for(var f in e)if(d&&d.properties)d=d.properties[e[f]];else if(d&&d.ref&&d.denormalize&&d.denormalize.indexOf(e[f])>-1){var h=b.getModel(d.ref);if(d=angular.copy(b.getFieldFromSchema(e[f],h.schema)),d&&d.title){var i=a.lastIndexOf(".");d.title=g.prettifyTitle(a.substring(0,i)+"."+d.title)}}else d=c[e[f]];return d},angular.forEach(Object.keys(a),function(c){b[c]=a[c]}),b}]})}(),function(){"use strict";angular.module("injectorApp").factory("selectCacheService",function(){return{TIMEOUT_MS:750,timers:{},cache:{}}}).provider("selectCache",function(){this.$get=["$rootScope","models","selectCacheService",function(a,b,c){function d(a,d){b.getModelConfig(a,function(e){var f={};d&&e.shard.shardKey&&(f[e.shard.shardKey]=d);var g=Object.keys(c.cache[a].gets);1==g.length?f[e.id]=g[0]:(f.$or=[],angular.forEach(g,function(b){if(!c.cache[a].gets[b].result){var d={};d[e.id]=b,f.$or.push(d)}})),b.search(a,{query:f},function(b,d){angular.forEach(b,function(b){var d=b[e.id];c.cache[a].gets[d].result=b}),angular.forEach(Object.keys(c.cache[a].gets),function(b){var d=c.cache[a].gets[b];d.cbks&&(angular.forEach(d.cbks,function(a){a(d.result)}),delete d.cbks)})})})}var e={};return a.$on("$routeChangeStart",function(a,b,d){b!=d&&(c.cache={},angular.forEach(Object.keys(c.timers),function(a){clearTimeout(c.timers[a]),delete c.timers[a]}))}),e.search=function(a,d,e,f){var g=JSON.stringify(d);c.cache[a]||(c.cache[a]={}),c.cache[a].posts||(c.cache[a].posts={});var h=c.cache[a].posts[g];h?!h.res&&h.cbks?h.cbks.push(f):(h.cbks.push(f),angular.forEach(h.cbks,function(a){a(h.res.response,h.res.count)}),h.cbks=[]):(c.cache[a].posts[g]={},c.cache[a].posts[g].cbks=[f],b.search(a,d,e,function(b,d){c.cache[a].posts[g].res={response:b,count:d},angular.forEach(c.cache[a].posts[g].cbks,function(a){a(b,d)}),c.cache[a].posts[g].cbks=[]}))},e.getDocument=function(a,b,e,f){c.cache[a]||(c.cache[a]={}),c.cache[a].gets||(c.cache[a].gets={}),b?(c.cache[a].gets[b]||(c.cache[a].gets[b]={}),c.cache[a].gets[b].cbks||(c.cache[a].gets[b].cbks=[]),c.cache[a].gets[b].result?f(c.cache[a].gets[b].result):c.cache[a].gets[b].cbks.indexOf(f)==-1&&(c.cache[a].gets[b].cbks.push(f),c.timers[a]&&clearTimeout(c.timers[a]),c.timers[a]=setTimeout(function(){d(a,e)},c.TIMEOUT_MS))):f()},e}]})}(),function(){"use strict";angular.module("injectorApp").factory("httpResponseInterceptor",["$q","$location","$routeParams","flash","$injector","configs",function(a,b,c,d,e,f){return{response:function(b){if(b.headers("routeinjector")&&b.headers("routeinjector")!==f.backoffice.version){var c=e.get("ngDialog");0===c.getOpenDialogs().length&&c.open({template:"dialogVersionMismatch",className:"ngdialog-theme-default ngdialog-theme-custom"})}return 401===b.status?console.log("Response 401"):201===b.status&&d.success("Done","Document saved successfully"),b||a.when(b)},responseError:function(g){function h(a){function e(){"/login"!=b.url()&&"/logout"!=b.url()&&"/"!=b.url()&&(c.schema?b.path("/model/"+c.schema):b.path("/"))}if(401===g.status)console.log("Response Error 401",g),e(),"/login"!=b.url()&&d.error("Unauthorized",JSON.stringify(g.data));else if(500===g.status)d.error("Internal server error",JSON.stringify(g.data));else if(400===g.status)d.error("Bad Request",JSON.stringify(g.data));else if(404!==g.status||a)if(404===g.status&&a)d.warning("Property Not Found",JSON.stringify(g.data));else if(403===g.status)if(g.data&&g.data.errors){var f=[];angular.forEach(Object.keys(g.data.errors),function(a){f.push("<strong>"+a+"</strong> validation failed. Caused by: "+g.data.errors[a].message)}),f.splice(0,0,"Validation Error "+g.status),d.error.apply(this,f)}else d.error("Validation Error "+g.status,JSON.stringify(g.data));else 4!=Math.floor(g.status/100)&&5!=Math.floor(g.status/100)||(e(),d.error("Error "+g.status,JSON.stringify(g.data)));else e(),d.error("Not Found",JSON.stringify(g.data))}var i,j=e.get("models"),k=c.schema,l=c.id,m=f.app.prefix;return k?j.getModelConfig(k,function(a){var b="/"+a.path+"/"+l;m&&(b="/"+b),i=b!==g.config.url,h(i)}):h(!0),a.reject(g)}}}]).config(["$httpProvider",function(a){a.interceptors.push("httpResponseInterceptor")}])}(),function(){"use strict";angular.module("injectorApp").factory("dependsOn",["$http","configs","common","models",function(a,b,c,d){var e={};return e.find=function(a){function b(a,d){if("object"==typeof a)$.each(a,function(a,e){"dependsOn"==a&&c.push({path:d,field:e.field,params:e.params,func:e.func}),d=d?d+"."+a:a,b(e,d);var f=d.split(".");f.pop(),d=f.join(".")});else{var e=d.split(".");e.pop(),d=e.join(".")}}var c=[];return b(a),c},e.apply=function(f,g,h){function i(d,e,f){return function(g,i){if(g){var j=b.app.prefix+"/_"+d.path+"/"+e.func,k={};angular.forEach(e.params,function(a){k[a]=safeAccess(h,a)}),a.post(j,k).success(function(a){var b=e.path.replace(/properties\./g,"");void 0!==f&&(b=b.replace(/\.items/g,"["+f+"]")),c.setField(b,h,a)})}}}d.getModel(g,function(a){var b=e.find(a.schema);$.each(b,function(b,c){if(/(this\.)/.test(c.field)){var d=c.path.replace(/properties\./g,""),e=d.split(".")[0],g=c.field.replace(/(this\.)/,"");if(/(items)/.test(d))f.$watchCollection("model."+e,function(b,d){if(b&&b instanceof Array)for(var h in b){var j=e+"["+h+"]."+g;for(var k in c.params)c.params[k]=j;f.$watch("model."+j,i(a.config,angular.copy(c),angular.copy(h)))}});else{var h=e+"."+g;f.$watch("model."+h,i(a.config,angular.copy(c)))}}else f.$watch("model."+c.field,i(a.config,c))})})},e}])}(),function(){"use strict";angular.module("injectorApp").factory("common",["$rootScope",function(a){var b={};return b.hasAngularVariable=function(a){return/\{{(.*)\}}/.test(a)},b.deAngularizeUrl=function(a,c){return c.replace(/\{{(.*)\}}/g,function(c,d){var e=b.getField(d,a);return e})},b.getAngularVariables=function(a){return/\{{(.*)\}}/.exec(a)[1]},b.prettifyTitle=function(a,b){return a=a||"",b=b||".",a.replace(/(\.([a-z]|[A-Z]))/g,function(a){return" <i class='fa fa-angle-right'></i> "+a.replace(".","").toUpperCase()}).replace(/([A-Z])/g," $1").replace(/^./,function(a){return a.toUpperCase()})},b.getField=function(a,b){if(b){var c=a.split(".");if(c instanceof Array&&c.length>0){var d,e,f=b;for(var g in c)if(/(\[\d*\])/.test(c[g])){var h=c[g].replace(/(\[\d*\])/,""),i=c[g].match(/(\d*)(?=\])/)[0];f&&(i?f=f[h][i]:e=h)}else if(e){var j=f;d=[];for(var k in j[e])d.push(j[e][k][c[g]])}else f&&(f=f[c[g]]);return d?d:f}return b[a]}},b.setField=function(a,c,d){if(c){var e=a.split(".");if(e instanceof Array&&e.length>0)for(var f=c,g=0;g<e.length;g++){var h=e[g];if(/(\[\d*\])/.test(h)){var i,j=h.replace(/(\[\d*\])/,""),k=h.match(/(\d*)(?=\])/)[0];if(void 0===k)for(var l in f[j])i=e[g+1],b.setField(i,f[j][l],d);else i=e[g+1],b.setField(i,f[j][k],d)}else g<e.length-1?(f[h]||(f[h]={}),f=f[h]):f[h]=d}}},b.getAllSchemaFields=function(a,b){function c(a,e){var f=Object.keys(a);angular.forEach(f,function(f){a[f].properties?c(a[f].properties,e?e+b+f:f):a[f].denormalize?angular.forEach(a[f].denormalize,function(a){d.push((e?e+b:"")+f+b+a)}):d.push(e?e+b+f:f)})}b=b||".";var d=[];return c(a),d},b.processForm=function(a,b){var c;return a&&a.tabs?(c=c||[],c.push({type:"tabs",tabs:a.tabs})):a&&a.items&&(c=a.items),c=c||["*"]},b.randomNumber=function(){return(new Date).getTime()},b.getRandomQuery=function(){return"?r="+b.randomNumber()},b}])}(),function(){"use strict";angular.module("injectorApp").factory("search",["$rootScope","models",function(a,b){var c={};return{setQuery:function(a){c.query=a},clearQuery:function(){this.setQuery({})},getQuery:function(){return c.query},setSortBy:function(a){c.sortBy=a},addSortBy:function(a,b){c.sortBy={},c.sortBy[a]=b?1:-1},getSort:function(a){return c.sortBy?c.sortBy[a]:void 0},setSkip:function(a){c.skip=a},setLimit:function(a){c.limit=a},search:function(a,d){b.search(a,c,function(a,b){d(a,b,null)})},searchAndGroup:function(a,b){}}}])}(),function(){"use strict";angular.module("injectorApp").directive("sideMenu",function(){return{restrict:"E",scope:!1,templateUrl:"html/side-menu.html",controller:["$scope","$routeParams","$location","common","models","customMenu","$window","$rootScope",function(a,b,c,d,e,f,g,h){a.common=d,a.$on("$routeChangeStart",function(b,c,d){c.params.schema&&(a.actualSchema=c.params.schema)}),a.isDisabled=!1,a.isOpen=!1;var i=function(){a.sections=new Sections,angular.forEach(f,function(b){a.sections.add(b.section,b.title,b)}),a.sections.add("Gallery","Gallery",{clickTo:"gallery"}),e.getModels(function(b){angular.forEach(b,function(b){e.getModelConfig(b,function(c){c.hideMenu||(c.isSingle?e.getSingleModel(b,function(a){a?c.clickTo="model/"+b+"/update/"+a[c.id]:c.clickTo="model/"+b+"/new"}):c.clickTo="model/"+b,a.sections.add(c.section,b,c))})})})};i(),h.$on("invalidate",function(){i()}),a.openSection=function(b){a.actualSection=b},a.click=function(b,d,e){a.parentSchema=b,a.actualSchema=d,a.actualSection=b,e.clickTo?c.path(e.clickTo):e.url&&(g.location.href=e.url)},a.isInstanceOf=function(a){return a instanceof Section},a.debug=function(a,b){console.log(a,b)}}]}})}();var Section=function(){},Sections=function(){var a={};this.get=function(){return a},this.add=function(b,c,d){for(var e=b.split("."),f=a,g=0;g<e.length-1;)"undefined"==typeof f[e[g]]&&(f[e[g]]=new Section),f=f[e[g]],g++;f[e[e.length-1]]=f[e[e.length-1]]||new Section,f[e[e.length-1]][c]=d}};!function(){"use strict";angular.module("injectorApp").directive("scrollToItem",function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(a,b,c){b.on("click",function(){$("html,body").animate({scrollTop:$(a.scrollTo).offset().top},"slow")})}}})}(),function(){"use strict";angular.module("injectorApp").directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}])}(),function(){"use strict";angular.module("injectorApp").directive("injectorPunchcard",["$routeParams","models",function(a,b){return{restrict:"AE",scope:!0,templateUrl:"js/directives/injector-punchcard/injector-punchcard.html",link:function(c,d,e,f){var g=a.schema;b.getGraph(g,e.graph,function(a){c.elements=Object.keys(a),c.selected=c.elements[0],c.punchCardData=a[c.selected],c.$watch("selected",function(b){c.punchCardData=a[b]})})}}}])}(),function(){"use strict";angular.module("injectorApp").directive("injectorBargraph",["$routeParams","models",function(a,b){return{restrict:"AE",scope:!0,templateUrl:"js/directives/injector-bargraph/injector-bargraph.html",link:function(c,d,e,f){var g=a.schema;b.getModelConfig(g,function(a){b.getGraph(g,e.graph,function(b){var d={};for(var f in a.graphs){var g=a.graphs[f];g.title==e.graph&&(d=g)}if(c.elements=Object.keys(b),c.selected=c.elements[0],"series"==d.groupMode?c.selectEnabled=!1:"select"==d.groupMode?c.selectEnabled=!0:console.error("Invalid configuration at bargraph group Mode:",d.groupMode),c.selectEnabled===!0)c.barsData=[{key:c.selected,values:b[c.selected]}],c.$watch("selected",function(a){c.selectEnabled===!0&&(c.barsData=[{key:a,values:b[a]}])});else{c.barsData=[];for(var h in b)c.barsData.push({key:h,values:b[h]})}})})}}}])}(),function(){"use strict";angular.module("injectorApp").directive("modelButtons",["$routeParams","$http","$q","$route","models","$location",function(a,b,c,d,e,f){return{restrict:"AE",scope:!1,templateUrl:"js/directives/model-buttons/model-buttons.html",link:function(a,g,h,i){function j(){var b=a.elements.filter(function(a){return a.checked});if(b&&b.length>0){var c={$or:[]};return angular.forEach(b,function(a){c.$or.push({_id:a._id})}),c}return a.query}a.performAction=function(a){if(a.type&&"form"==a.type)e.postAsForm(a.path,a.data,"post");else if(a.type&&"location"==a.type)f.path(a.location);else{var c={method:a.method,url:a.path,headers:{"Content-Type":"application/json"},data:a.data};b(c)}},a.export=function(b){e.export(a.schema,b,j(),function(a){})},a.import=function(b){console.log("IMPORT",b,a.schema);var c="";e.import(a.schema,b,c,function(a){})},a.enableDelete=function(){if(!a.elements)return!1;var b=a.elements.filter(function(a){return a.checked});return b.length>0},a.removeSelected=function(){var b=a.elements.filter(function(a){return a.checked});b.length>0&&a.promptAlert(function(f){if(f){var g=[];angular.forEach(b,function(b){var d=c.defer();g.push(d.promise),e.getModelConfig(a.schema,function(c){var f;c.shard&&c.shard.shardKey&&(f=b[c.shard.shardKey]),a.isDisabled(b)?e.removeDocumentByMongoId(a.schema,b._id,f,function(a){d.resolve()}):e.removeDocument(a.schema,a.id(b),f,function(a){d.resolve()})})}),c.all(g).then(function(){d.reload()})}})}}}}])}(),function(){"use strict";angular.module("injectorApp").directive("searchInModel",["$routeParams","models","common","search",function(a,b,c,d){return{restrict:"AE",scope:!1,templateUrl:"js/directives/search-model/search-model.html",link:function(e,f,g,h){function i(a){var b={},c=k(a);if(c.err)return c;if(c.end){j(c.start),j(c.end);var d=c.start,e=c.end,f=0,g=0;void 0!=d.second&&(f=d.second),void 0!=e.second&&(g=e.second),void 0==d.hour&&void 0==e.hour&&void 0!=d.year&&void 0!=e.year?(b.$gte=new Date(d.year,d.month-1,d.day,0,0,0,0),b.$lte=new Date(e.year,e.month-1,e.day,23,59,59,999)):void 0!=d.hour&&void 0!=e.hour&&void 0!=d.year&&void 0!=e.year?(b.$gte=new Date(d.year,d.month-1,d.day,d.hour,d.minute,f,0),b.$lte=new Date(e.year,e.month-1,e.day,e.hour,e.minute,g,999)):void 0!=d.hour&&void 0!=e.hour&&void 0!=d.year&&void 0==e.year?(b.$gte=new Date(d.year,d.month-1,d.day,d.hour,d.minute,f,0),b.$lte=new Date(d.year,d.month-1,d.day,e.hour,e.minute,g,999)):void 0!=d.hour&&void 0==e.hour&&void 0!=d.year&&void 0!=e.year?(b.$gte=new Date(d.year,d.month-1,d.day,d.hour,d.minute,f,0),b.$lte=new Date(e.year,e.month-1,e.day,d.hour,d.minute,f,999)):b={err:"format invalid"}}else{j(c.start);var h=c.start;if(void 0==h.day&&void 0!=h.month&&void 0!=h.year&&void 0==h.hour)b.$gte=new Date(h.year,h.month-1,1,0,0,0,0),b.$lt=new Date(h.year,h.month,1,0,0,0,0);else if(void 0!=h.day&&void 0!=h.month&&void 0!=h.year&&void 0==h.hour)b.$gte=new Date(h.year,h.month-1,h.day,0,0,0,0),b.$lt=new Date(h.year,h.month-1,h.day+1,0,0,0,0);else if(void 0!=h.day&&void 0!=h.month&&void 0!=h.year&&void 0!=h.hour){var i=0;isNaN(h.second)||(i=h.second),b.$gte=new Date(h.year,h.month-1,h.day,h.hour,h.minute,i,0),b.$lte=new Date(h.year,h.month-1,h.day,h.hour,h.minute,i,999)}else b={err:"format invalid"}}return q(b),b}function j(a){var b=Number(a.year);b<100&&(b=b<46?2e3+b:1900+b,a.year=String(b))}function k(a){var b=a.split("-");switch(b.length){case 1:var c=l(b[0].trim());return c?{start:c}:{err:"format invalid"};case 2:var c=l(b[0].trim()),d=l(b[1].trim());return c&&d?{start:c,end:d}:{err:"format invalid"};default:return{err:"format invalid"}}}function l(a){var b=a.split(" ");switch(b.length){case 1:return m(b[0].trim());case 2:var c=m(b[0].trim()),d=m(b[1].trim());return c&&d?(c.hour=d.hour,c.minute=d.minute,c.second=d.second,c):null;default:return null}}function m(a){return a.indexOf(":")!=-1?o(a):a.indexOf("/")!=-1?p(a):null}function n(a){if(void 0!=a)return Number(a)}function o(a){var b=/^(\d?\d):(\d\d)(:(\d\d))?$/g,c=b.exec(a);return c?{hour:n(c[1]),minute:n(c[2]),second:n(c[4])}:null}function p(a){var b=/^((\d?\d)\/)?(\d?\d)\/(\d{2,4})$/g,c=b.exec(a);if(c){var d={day:n(c[2]),month:n(c[3]),year:n(c[4])};return d}return null}function q(a){a.$gte&&console.log("GTE",a.$gte.toLocaleString("es-ES")),a.$gt&&console.log("GT ",a.$gt.toLocaleString("es-ES")),a.$lte&&console.log("LTE",a.$lte.toLocaleString("es-ES")),a.$lt&&console.log("LT ",a.$lt.toLocaleString("es-ES")),console.log("----------------------------------------")}e.searches=[],e.models=b;var r=a.schema;e.buildPath=function(a,d){var e,f=b.getFieldFromSchema(a,d);if(f&&f.title){var g=a.lastIndexOf(".");e=g>-1&&f.title.indexOf("<i")==-1?c.prettifyTitle(a.substring(0,g)+"."+f.title):f.title}else e=c.prettifyTitle(a);return e},e.updateSearch=function(a,c,d){var f;a.field&&(f=e.availableFields.indexOf(a.field),f==-1&&e.availableFields.push(a.field));var g=b.getFieldFromSchema(c,e.schema);a.title=g.title,a.field=c,a.placeholder={modelName:r,field:a.field},a.ref=g.ref&&!g.denormalize?g.ref:void 0,f=e.availableFields.indexOf(c),f>-1&&e.availableFields.splice(f,1),d||e.search()},e.addSearch=function(a){var b={};a=a||e.availableFields[0],b.clear=function(){b.value="",e.search()},b.remove=function(){var a=e.searches.indexOf(b);a>-1&&e.searches.splice(a,1),a=e.availableFields.indexOf(b.field),a==-1&&e.availableFields.push(b.field),e.search()},e.updateSearch(b,a,!0),e.searches.push(b)},b.getModelSchema(r,function(a){a&&(e.schema=a,e.allFields=c.getAllSchemaFields(a),e.availableFields=e.allFields.filter(function(c){var d=b.getFieldFromSchema(c,a);return d&&"image"!=d.format&&"mixed"!=d.format}))}),b.getModelConfig(r,function(a){e.addSearch(a.displayField)}),e.search=function(){var a={};b.getModelSchema(r,function(c){angular.forEach(e.searches,function(d){var e={};if(d.value){var f=b.getFieldFromSchema(d.field,c);if(f)if("string"!=f.type||f.format||f.ref)if("string"==f.type&&"date"==f.format){var g=i(d.value);""!==d.value&&(void 0==g.err?e[d.field]=g:alert("Format invalid in field "+d.field))}else f.ref&&!f.denormalize?e[d.field]=d.value:f.ref&&f.denormalize?e[d.field]={$regex:d.value,$options:"i"}:e[d.field]=d.value;else""!==d.value&&(e[d.field]={$regex:d.value,$options:"i"})}angular.extend(a,e)})}),d.setQuery(a),d.setSkip(0),e.$parent.search()}}}}]).directive("searchRefInModel",["models","common",function(a,b){return{restrict:"AE",scope:!1,templateUrl:"js/directives/search-model/search-ref-model.html",link:function(c,d,e,f){function g(b){return function(d,e){return a.getModel(h,function(f){var g=f.config,k="";k=b instanceof Object?b[g.id]:b,a.getDocument(h,k,function(b){i=g.displayField,j=g.id;var k={};k.query={};var l=d.search;k.query.$or=[];var m={};if(m[i]={$regex:l,$options:"i"},k.query.$or.push(m),"_id"!=g.id&&f.schema[g.id]&&"string"==f.schema[g.id].type){var n={};n[j]={$regex:l,$options:"i"},k.query.$or.push(n)}k.limit=20,k.skip=e,a.getShard(h)&&(k[a.getShard(h).key]=a.getShard(h).value),a.search(h,k,function(a,d){if(e?c.searchRes=c.searchRes.concat(a):c.searchRes=a,b){var f=c.searchRes.some(function(a){return a[g.id]==b[g.id]});f||c.searchRes.splice(0,0,b)}})})})}}c.elemsearch=c.$eval(e.elemsearch);var h=c.elemsearch.ref;if(d.select){var i="",j="",k=g(c.$eval(e.ngModel));c.disabled=!1,c.searchEnabled=!0,c.searchRes=[],c.search=k,c.printSelectedElement=function(a){if(a){var c=b.getField(i,a);return c&&""!==c&&c.length>0?c+" <"+a[j]+">":"No display field. ID: <"+a[j]+">"}},c.selectDisplayField=function(a){if(a){var c=b.getField(i,a);return c&&""!==c&&c.length>0?c:"<empty>"}},c.selectIdField=function(a){if(void 0!==a)return a[j]||"No ID"},c.$on("refreshSelect2"+h,function(){console.log("REFRESH SELECT2"),k()}),d.find("ul").bind("scroll",function(){var a=arguments[0].target;a.scrollTop+a.offsetHeight>a.scrollHeight&&k(c.$select,a.children[0].children.length-2)})}}}}])}(),function(){"use strict";angular.module("injectorApp").directive("ellipsis",function(){return{restrict:"A",scope:!0,link:function(a,b,c,d){var e=b.width();b.css("width",e),b.css("text-overflow","ellipsis"),b.css("overflow","hidden"),b.css("white-space","nowrap")}}})}(),function(){"use strict";angular.module("injectorApp").directive("mAppLoading",["$animate",function(a){function b(b,c,d){a.leave(c.children().eq(1)).then(function(){c.remove(),b=c=d=null})}return{link:b,restrict:"C"}}])}(),function(){"use strict";angular.module("injectorApp").controller("CreateController",["$scope","$http","$location","$routeParams","models","$controller",function(a,b,c,d,e,f){var g=d.schema;a.action="create",e.getModel(g,function(b){if(b.config.post){a.model={};var d=angular.copy(b);a.m=b,a.m_copy=d,a.action="create",f("FormController",{$scope:a})}else c.path("/model/"+g)})}])}(),function(){"use strict";angular.module("injectorApp").controller("GraphsController",["$scope","$routeParams","$sce","$compile","models",function(a,b,c,d,e){a.schema=b.schema,e.getModelConfig(a.schema,function(b){a.config=b,a.graphs=b.graphs}),a.getTag=function(a){var b=a.type;
return"<injector-"+b+' graph="'+a.title+'"></injector-'+b+">"}}])}(),function(){"use strict";angular.module("injectorApp").controller("UpdateController",["$scope","$http","$routeParams","$location","models","$controller",function(a,b,c,d,e,f){var g=c.schema,h=c.id,i=c.shard;e.getModel(g,function(b){e.getDocument(g,h,i,function(c){a.prune(c),a.action="update",a.model=c||{};var d=angular.copy(b);a.m=b,a.m_copy=d,f("FormController",{$scope:a})})}),a.prune=function(b){for(var c in b){var d=b[c];d&&("object"==typeof d||d instanceof Array)&&a.prune(d),null==d&&(b[c]=void 0)}}}])}(),function(){"use strict";angular.module("injectorApp").controller("FormController",["$rootScope","$scope","$http","$location","$routeParams","$anchorScroll","$timeout","$modal","models","configs","dependsOn","common","$window","flash","$translate",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a){var c=Object.keys(a);for(var d in c)if(a[c[d]]){if(a[c[d]].editOnCreate){var e=b.action.toLowerCase();a[c[d]].readonly=!("create"===e)}a[c[d]].i18nTitle&&(a[c[d]].title=o.instant(a[c[d]].i18nTitle));var f=a[c[d]].type;"array"!==f&&"object"!==f||!a[c[d]].properties||p(a[c[d]].properties)}}var q=e.schema,r=e.id,s=!1;b.buttonsPosition=j.backoffice.buttonsPosition||"bottom",b.m=angular.copy(b.m_copy),p(b.m.schema),b.schema={type:"object",title:q,action:b.action,properties:b.m.schema},b.form=l.processForm(b.m.config.form),"create"==b.action.toLowerCase()&&i.getShard(q)&&i.getShard(q).value&&(b.model[i.getShard(q).key]=i.getShard(q).value),a.$on("shardChangeEvent",function(){"create"==b.action.toLowerCase()&&i.getShard(q)&&i.getShard(q).value&&(b.model[i.getShard(q).key]=i.getShard(q).value)}),k.apply(b,q,b.model),g(function(){b.$watch("model",function(a,b){angular.equals(a,b)||(s=!0)},!0)},0),b.schemaHREF=function(){d.path("/model/"+q),d.hash("")},b.submitForm=function(a,c,e){b.$broadcast("schemaFormValidate"),a.$valid?"update"==b.action.toLowerCase()&&b.m.config.put?i.putDocument(q,r,c,function(a){"200"==a.status&&(s=!1,n.success("Done","Document saved successfully"),b.$broadcast("postedDocument",a.data),b.$broadcast("puttedDocument",a.data),e||(d.path("/model/"+q),d.hash("")))}):"create"==b.action.toLowerCase()&&b.m.config.post&&i.postDocument(q,c,function(a){"201"==a.status&&(s=!1,n.success("Done","Document saved successfully"),b.$broadcast("postedDocument",a.data),e?(d.path("/model/"+q+"/update/"+a.data[Object.keys(a.data)[0]]),d.hash("")):(d.path("/model/"+q),d.hash("")))}):(b.validation=!a.$valid,b.validationErrors=a.$error,d.hash("error"),f.yOffset=100,f())},b.cancel=function(){m.history.back()},b.$on("$locationChangeStart",function(a,c,e){if(b.ngForm.$valid&&s){a.preventDefault();var f=h.open({templateUrl:"changedDocument.html",controller:"ModalChangedCtrl",size:"sm",resolve:{items:function(){return b.items}}});f.result.then(function(){b.submitForm(b.ngForm,b.model)},function(){s=!1;var a=d.absUrl().length-d.url().length;d.path(c.substring(a))})}}),b.$on("bkButton",function(a,d){if("api"==d.action){var e,f=d.url,g=function(a){return a.replace(/[^\/]*:([^\/]*)+/g,function(a,c){return safeAccess(b.model,c)})};switch(f=g(f),d.method.toUpperCase()){case"GET":e=c.get(f);break;case"PUT":e=c.put(f,b.model);break;case"POST":var h={};d.body?angular.extend(h,d.body):h=b.model,e=c.post(f,h);break;case"DELETE":e=c.delete(f);break;default:throw new Error("Method not configured properly")}e&&e.success(function(a){angular.forEach(Object.keys(a),function(c){b.model[c]=a[c]})}).error(function(a){console.error(a)})}else"function"==d.action&&window[d.func](b.model,b.m.schema)}),a.$on("$translateChangeSuccess",function(){p(b.schema.properties),b.$broadcast("schemaFormRedraw")})}]).controller("ModalChangedCtrl",["$scope","$modalInstance","items",function(a,b,c){a.ok=function(){b.close("ok")},a.cancel=function(){b.dismiss("cancel")}}])}(),function(){"use strict";angular.module("injectorApp").controller("LoginController",["$http","$scope","$document","$location","loginProvider",function(a,b,c,d,e){b.update=function(a){e.login(a,function(a){a?d.path("/"):b.loginError="incorrect login"})}}])}(),function(){"use strict";angular.module("injectorApp").filter("encodeURIComponent",function(){return window.encodeURIComponent}).controller("MainController",["$rootScope","$scope","$q","loginProvider","models","common",function(a,b,c,d,e,f){b.postLoginFuncs=[],b.postLoginFuncs.push(function(){e.getModels(function(a){b.schemas={},angular.forEach(a,function(a){e.getModelConfig(a,function(c){b.schemas[a]=c,d.getUser(function(){}),c.isSingle&&e.getSingleModel(a,function(d){d?b.schemas[a].redirectTo="#/model/"+a+"/update/"+d[c.id]:b.schemas[a].redirectTo="#/model/"+a+"/new"})})})})}),b.pretty=function(a){return f.prettifyTitle(a)},b.schemaHREF=function(a,b){return b.redirectTo||"#/model/"+a},angular.element("body").ready(function(){a.$broadcast("bodyReady","MainController")}),a.$on("login",function(a,c){angular.forEach(b.postLoginFuncs,function(a){a()}),b.postLoginFuncs=[]}),a.$on("logout",function(a,b){})}])}(),function(){"use strict";angular.module("injectorApp").controller("ModelController",["$scope","$http","$route","$routeParams","$modal","$location","common","models","flash","configs","search",function(a,b,c,d,e,f,g,h,i,j,k){var l=20;a.flash=i,a.common=g,a.removeDisabled="disabled",a.maxSize=10,a.schema=d.schema,a.create=!1,a.checkedGroupIds={},k.clearQuery(),a.$watch("removeAll",function(b){if(void 0!==b)for(var c in a.elements)a.elements[c].checked=b}),h.getModel(a.schema,function(b){return a.config=b.config,a.schemaForm=b.schema,b.config.isSingle?void f.path("/"):(a.config.allDisplayFields=[],a.config.allDisplayFields.push(a.config.displayField),a.config.extraDisplayFields&&(a.config.allDisplayFields=a.config.allDisplayFields.concat(a.config.extraDisplayFields)),a.search=function(b){void 0!==b&&k.setSkip(b),k.search(a.schema,function(b,c,d){b&&(a.elements=b),a.totalElements=c})},a.itemsPerPage=a.userItemsPerPage=j.backoffice.itemsPerPage||l,k.setLimit(a.itemsPerPage),k.setSkip(0),b.config.defaultSearch&&k.setSortBy(b.config.defaultSearch),a.search(),a.pageChanged=function(){if(a.itemsPerPage=a.userItemsPerPage,a.currentPage>0&&a.itemsPerPage>0){var b=(a.currentPage-1)*a.itemsPerPage;k.setSkip(b)}else k.setSkip(0);k.setLimit(a.itemsPerPage),a.search()},a.id=function(b){return b[a.config.id]},a.shard=function(b){return b[a.config.shard.shardKey]},a.hasShard=function(b){var c=a.config.shard&&a.config.shard.shardKey;return c&&b[a.config.shard.shardKey]},a.getUrl=function(b,c){var d;d=b.__t?b.__t:c;var e="#/model/"+d+"/update/"+encodeURIComponent(a.id(b));return a.hasShard(b)&&(e+="/"+encodeURIComponent(a.shard(b))),e},a.isDisabled=function(b){return!(b[a.config.id]&&""!==b[a.config.id])},a.displayCustomField=function(a,b,c){var d=g.getField(a,b),e=h.getFieldFromSchema(a,c);return e&&"date"===e.format&&d&&""!==d&&(d=new Date(Date.parse(d)).toLocaleString()),void 0===d||""===d?"<empty>":d},a.sortBy=function(b,c){k.addSortBy(b,c),a.search(0)},a.getSort=function(a){return k.getSort(a)},void a.$on("shardChangeEvent",function(b,c){a.search(0)}))}),a.promptAlert=function(b){var c;c&&b(c);var d=e.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:"sm",resolve:{items:function(){return a.items}}});d.result.then(function(){c=!0,b(!0)})}}]).filter("to_trusted",["$sce",function(a){return function(b){return b?a.trustAsHtml(b.toString()):b}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(a,b,c){a.ok=function(){b.close("ok")},a.cancel=function(){b.dismiss("cancel")}}]).controller("ImportModalInstanceCtrl",["$scope","$modalInstance","items",function(a,b,c){}])}(),function(){"use strict";angular.module("injectorApp").controller("NavbarController",["$scope","$location","loginProvider",function(a,b,c){var d=function(){c.getUser(function(b){a.user=b})};d(),a.$on("login",function(a,b){d()}),a.logout=function(){c.logout(),b.path("/logout")}}])}(),function(){"use strict";angular.module("injectorApp").controller("ShardingController",["$scope","$routeParams","$rootScope","models","configs",function(a,b,c,d,e){var f;a.$on("$routeChangeSuccess",function(b,c){f=c.params.schema,void 0==f&&(f=c.$$route.modelName),f?d.getModel(f,function(b){b.config.shard?(a.shardKey=b.config.shard.shardKey,a.shardKeyText="Select "+a.shardKey+" shard",a.shardValues=b.config.shard.shardValues,d.getShard(f)?a.shardKeyText="Using "+d.getShard(f).key+" "+d.getShard(f).value:b.config.shard.filtered?(a.locked=!0,a.setShard(a.shardValues[0])):a.locked=!1):(a.shardKey=void 0,a.shardKeyText=void 0,a.shardValues=void 0)}):(a.shardKey=void 0,a.shardKeyText=void 0,a.shardValues=void 0)}),a.setShard=function(b){a.shardKeyText="Using "+a.shardKey+" "+b,d.setShard(a.shardKey,b,f),c.$broadcast("shardChangeEvent")},a.removeShard=function(){a.shardKeyText="Select "+a.shardKey+" shard",d.removeShard(f),c.$broadcast("shardChangeEvent")},a.shardKey=void 0}])}(),function(){"use strict";angular.module("injectorApp").controller("TranslateController",["$scope","$translate","configs",function(a,b,c){a.languages=["en","es"],c.backoffice.uniqueLanguage?(a.showLanguages=!1,b.use(c.backoffice.uniqueLanguage)):(a.showLanguages=!0,a.use=function(a){b.use(a)})}])}();
//# sourceMappingURL=ri-backoffice.min.js.map